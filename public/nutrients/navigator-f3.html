<!DOCTYPE html>
<html lang="en" class="h-100">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="" />
  <meta name="author" content="David Cifuentes" />
  <meta name="generator" content="" />
  <title>NAVIGATOR N3</title>

  <!-- Bootstrap core CSS -->
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous" />
  <!-- Custom styles for this template -->
  <link href="../css/product.css" rel="stylesheet" />
</head>

<body class="d-flex flex-column h-100">
  <navbar></navbar>

  <main class="flex-shrink-0">
    <div class="container-fluid pt-5">
      <div class="pt-3 text-center">
        <!--<img class="d-block mx-auto mb-4" src="../assets/brand/bootstrap-logo.svg" alt="" width="72" height="57"> -->
        <h2>NAVIGATOR F3 (Fertilicalc)</h2>
        <p>
          The tool allows you to calculate the NPK requirements for your plot (based on the fertilicalc model ).
        </p>
      </div>

      <div class="card" id="step1">
        <div class="card-header">1.- General Data</div>
        <div class="card-body">
          <form class="needs-validation" id="formPlotNavigatorF3" novalidate>
            <div class="card">
              <h5 class="card-header bg-success text-white">Plot</h5>
              <div class="card-body">

                <div class="row">
                  <div class="col-md-12">
                    <div class="table-responsive">
                      <table class="table" id="tableNPKCrops">
                        <thead>
                          <tr>
                            <th scope="col">#</th>
                            <th scope="col"></th>
                            <th scope="col">Crop</th>
                            <!-- 
                              <th scope="col">Type of crop</th>
                              <th scope="col">Application method</th>
                              -->
                            <th scope="col">Yield</th>
                            <th scope="col">CV (%)</th>
                            <th scope="col">HI (%)</th>
                            <th scope="col">FRES (%)</th>
                            <th scope="col">N (%)</th>
                            <th scope="col">P (%)</th>
                            <th scope="col">K (%)</th>
                            <th scope="col">Burning</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr class="trow" data-row="0">
                            <th scope="row">1</th>
                            <td></td>
                            <td>
                              <select class="form-select" name="crops[0][cropID]" required
                                onchange="onChangeCrop(this)">
                                <option value="">Choose...</option>
                              </select>
                              <input type="hidden" class="form-control" name="crops[0][crop_name]" placeholder="" />
                              <input type="hidden" class="form-control" name="crops[0][crop_latin_name]"
                                placeholder="" />
                            </td>
                            <!-- 
                              <td>
                                <select class="form-select" name="crops[0][crop_type]" required>
                                  <option value="meadows">Meadows</option>
                                  <option value="rainfedCultivation">Rainfed cultivation</option>
                                  <option value="floodedCrops">Flooded crops</option>
                                </select>
                              </td>
                              <td>
                                <select class="form-select" name="crops[0][application_method]" required>
                                  <option value="b">Application for flooded fields</option>
                                  <option value="i">Application of fertilizer incorporated</option>
                                  <option value="s">Application of fertilizer in solution</option>
                                  <option value="bf;i/f">Fertilizer application before flooding</option>
                                  <option value="bpi">Application at the beginning of the panicle</option>
                                </select>
                              </td>
                              -->
                            <td>
                              <input type="number" class="form-control" name="crops[0][yield]"
                                placeholder="Crop yield (kg commercial product/ha)" min="0" required />
                            </td>
                            <td>
                              <input type="number" class="form-control" name="crops[0][CV]"
                                placeholder="Coefficient of Variation of yield (%)" min="0" max="100" required />
                            </td>
                            <td>
                              <input type="number" class="form-control" name="crops[0][HI_est]"
                                placeholder="Harvest Index (%)" min="0" max="100" required />
                            </td>
                            <td>
                              <input type="number" class="form-control" name="crops[0][fmc_r]"
                                placeholder="Fraction of crop residues remaining in the field after harvest (%)" min="0"
                                max="100" required />
                            </td>
                            <td>
                              <input type="number" class="form-control" name="crops[0][Nc_h]"
                                placeholder="N concentration of harvested organ (% over dry mass)" min="0" max="100"
                                step="any" required />
                            </td>
                            <td>
                              <input type="number" class="form-control" name="crops[0][Pc_h]"
                                placeholder=" P concentration of harvested organ (% over dry mass)" min="0" max="100"
                                step="any" required />
                            </td>
                            <td>
                              <input type="number" class="form-control" name="crops[0][Kc_h]"
                                placeholder=" K concentration of harvested organ (% over dry mass)" min="0" max="100"
                                step="any" required />
                            </td>

                            <td>
                              <input type="checkbox" class="form-check-input" name="crops[0][burning]" />
                            </td>
                          </tr>
                        </tbody>
                        <tfoot>
                          <tr>
                            <td colspan="8">
                              <button type="button" class="btn btn-success" id="addMoreCrops">
                                + Add rotation crops
                              </button>
                              <!--   
                                    <label class="form-check-label" for="previous_crop"
                                    >Do you want to add information from the previous crop?</label>
                                    <input type="radio" name="previous_crop" value="yes" id="previosCropYes">
                                    <label for="previosCropYes">Yes</label>
                
                                    <input type="radio" name="previous_crop" value="no" id="previosCropNo">
                                    <label for="previosCropNo">No</label>
                                  -->
                            </td>
                            <td colspan="4">

                            </td>
                          </tr>
                        </tfoot>
                      </table>
                    </div> <!-- table-responsive -->
                  </div> <!-- col-md-12 -->
                </div> <!-- row -->
                <div class="row">
                  <div class="col-md-4">
                    <label for="soilType" class="form-label">Type of soil</label>
                    <select class="form-select" id="soilType" name="plot[soil_type]" required></select>
                    <div class="invalid-feedback">
                      Please select a valid soil type.
                    </div>
                  </div>

                  <div class="col-md-2">
                    <label for="som" class="form-label" title="Soil organic matter (%)">SOM (%)</label>
                    <input type="number" class="form-control" id="som" name="plot[SOM]" min="0" step="any"
                      placeholder="Soil organic matter (%)" value="0" />
                  </div>
                  <div class="col-md-2">
                    <label for="cec" class="form-label" title="Cation Exchange Capacity">
                      CEC (meq/kg)</label>
                    <input type="number" class="form-control" id="cec" name="plot[CEC]" min="0"
                      placeholder="Cation Exchange Capacity" value="80" />
                  </div>
                  <div class="col-md-2">
                    <label for="ph" class="form-label">pH </label>
                    <input type="number" class="form-control" id="ph" name="plot[pH]" min="0" placeholder="Soil pH"
                      value="7.0" />
                  </div>

                  <div class="col-md-2">
                    <br />
                    <input type="checkbox" class="form-check-input" id="tillage" name="plot[tillage]" />
                    <label class="form-check-label" for="tillage">Tillage</label>
                  </div>

                  <div class="col-md-2">
                    <label for="soilPConc" class="form-label">Soil P mg/kg</label>
                    <input type="number" class="form-control" id="soilPConc" name="plot[Pc_s]" min="0"
                      placeholder="Soil P concentration (ppm)" value="0" />
                  </div>
                  <div class="col-md-2">
                    <label for="soilKConc" class="form-label">Soil K mg/kg</label>
                    <input type="number" class="form-control" id="soilKConc" name="plot[Kc_s]" min="0"
                      placeholder="Soil K concentration (ppm)" value="0" />
                  </div>

                  <div class="col-md-3">
                    <label for="soilPMethod" class="form-label">Method of soil P analysis</label>
                    <select class="form-select" id="soilPMethod" name="plot[P_soil_method]" disabled>
                      <option value="">Choose...</option>
                      <option value="0">Olsen</option>
                      <option value="1">Ammonium lactate</option>
                      <option value="2">Mehlich III</option>
                      <option value="3">Bray</option>
                      <option value="4">Ammonium acetate + EDTA</option>
                      <option value="5">Calcium lactate</option>
                      <option value="6">Calcium lactate acetate</option>
                      <option value="7">Paper strip</option>
                      <option value="8">Acid ammonium acetate</option>
                      <option value="9">H2O</option>
                      <option value="10">saturated water</option>
                      <option value="11">Ca Cl2</option>
                    </select>
                    <div class="invalid-feedback">
                      Please select a valid method of soil P analysis
                    </div>
                  </div>

                  <div class="col-md-3">
                    <label for="pStrategy" class="form-label">PK strategy</label>
                    <select class="form-select" id="pStrategy" name="plot[PK_strategy]"></select>
                    <div class="invalid-feedback">
                      Please select a valid method of soil PK strategy
                    </div>
                  </div>

                  <div class="col-md-2">
                    <label for="waterSupply" class="form-label">Water supply</label>
                    <select class="form-select" id="waterSupply" name="plot[water_supply]">
                      <option value="0">Irrigated/humid</option>
                      <option value="1">Rainfed /dry</option>
                    </select>
                    <div class="invalid-feedback">
                      Please select a Water supply
                    </div>
                  </div>
                </div>
                <!-- 
                  <div class="row">
                    <div class="col-md-2">
                      <label for="leachingNinit" class="form-label">Ninit (kg N/ha) </label>
                      <input type="number" class="form-control" name="plot[Nc_s_initial]" min="0" step="any"
                        placeholder="Ninit (kg N/ha)" value="0" />
                      <div class="invalid-feedback">
                        Ninit (kg N/ha)
                      </div>
                    </div>
                    <div class="col-md-2">
                      <label for="leachingNinit" class="form-label">N water </label>
                      <input type="number" class="form-control" name="plot[Nc_water]" min="0" step="any"
                        placeholder="N water" value="0" />
                      <div class="invalid-feedback">
                        N water
                      </div>
                    </div>
                  </div>
                  -->

                <!-- Desnitrification -->
                <!-- 
                  <div class="row">
                    <div class="col-md-2">
                      <label for="desnitrificationCase" class="form-label">Case of denitrification</label>
                      <select class="form-select" id="desnitrificationCase" name="plot[case_desnitrification]" required>
                        <option value="tilledNFertilizer">Tilled (N from fertilizer)</option>
                        <option value="noTillage">No tillage</option>
                        <option value="tilledNManure">Tilled (N from manure)</option>
                      </select>
                    </div>

                    <div class="col-md-2">
                      <label for="desnitrificationDrainage" class="form-label" title="Soil pH">Rate of drainage</label>
                      <select class="form-select" id="desnitrificationDrainage" name="plot[drainage]" required>
                        <option value="veryHigh">Very High</option>
                        <option value="high">High</option>
                        <option value="medium">Medium</option>
                        <option value="low">Low</option>
                        <option value="veryLow">Very Low</option>
                      </select>
                    </div>
                  </div>
                  -->
                <!-- Volatilization -->
                <!-- 
                  <div class="row">

                    
                    <div class="col-md-2">
                      <label for="volatilizationMethod" class="form-label">Application method</label>
                      <select class="form-select" id="volatilizationMethod" name="method" required>
                        <option value="b">Application for flooded fields</option>
                        <option value="i">Application of fertilizer incorporated</option>
                        <option value="s">Application of fertilizer in solution</option>
                        <option value="bf;i/f">Fertilizer application before flooding</option>
                        <option value="bpi">Application at the beginning of the panicle</option>
                      </select>
                    </div>

                    <div class="col-md-2">
                      <label for="volatilizationFertilizerType" class="form-label" title="Fertilizer type">Fertilizer
                        type </label>
                      <select class="form-select" id="volatilizationFertilizerType" name="fertilizer_type" disabled>

                      </select>
                    </div>
                    


                    <div class="col-md-2">
                      <label for="volatilizationClimate" class="form-label" title="Climate">
                        Climate </label>
                      <select class="form-select" id="volatilizationClimate" name="plot[climate]" required>
                        <option value="tempered">Tempered</option>
                        <option value="tropical">Tropical</option>
                      </select>
                    </div>
                  </div>
                  -->
                <!-- Leaching -->
                <!--
                  <div class="row">
                  
                    <div class="col-md-2">
                      <label for="leachingNinit" class="form-label">Ninit (kg N/ha) </label>
                      <input type="number" class="form-control" name="plot[Nc_s_initial]" min="0" step="any"
                        placeholder="Ninit (kg N/ha)" value="0" />
                      <div class="invalid-feedback">
                        Ninit (kg N/ha)
                      </div>
                    </div>
              
                
                    <div class="col-md-2">
                      <label for="leachingZ" class="form-label">Soil depth (mm)</label>
                      <input type="number" class="form-control" name="plot[depth_s]" min="0" step="any"
                        placeholder="Soil depth (mm)" value="0.3" disabled />
                      <div class="invalid-feedback">
                        Soil depth (mm)
                      </div>
                    </div>

                    <div class="col-md-2">
                      <label for="leachingAnnualRainfall" class="form-label" title="Annual rainfall (mm)">Annual rainfall (mm)
                      </label>
                      <input type="number" class="form-control" name="plot[rainfall_annual]" min="0" step="any"
                        placeholder="Annual rainfall (mm)" value="0" />
                    </div>
                    <div class="col-md-3">
                      <label for="leachingPw" class="form-label" title="Total rainfall (mm) during autumn and winter ">
                        Total rainfall Autumn &  Winter (mm) </label>
                      <input type="number" class="form-control" id="leachingPw" name="plot[rainfall_winter]" min="0"
                        placeholder="Total rainfall Autumn &  Winter" value="0" />
                    </div>
                    <div class="col-md-3">
                      <label for="leachingAverageWater" class="form-label"
                        title="Average water content during percolation">
                        Mean water - percolation  (m3m-3) </label>
                      <input type="number" class="form-control" id="leachingAverageWater"
                        name="plot[average_water_percolation]" min="0" placeholder="Average water percolation" value="0" />
                    </div>
                  </div>
                  -->
                <div class="row">
                  <div class="col-md-4">
                    <br/>
                    <button type="button" class="btn btn-primary" id="calculateNPKrequirements">
                      <i class="fa fa-pagelines"></i> Calculate nutrient
                      requirements
                    </button>
                  </div>
                </div>

              </div><!-- card-body -->
            </div> <!-- card-->
          </form>
        </div> <!-- card-body -->
      </div> <!-- card step1 -->
      <br />
      <!-- STEP 2 -->
      <div class="card d-none" id="step2">
        <div class="card-header">2.- Calculation of fertilizer requirements:</div>
        <div class="card-body">
          <section id="NPKresults" class="d-none">
            <div class="row">
              <div class="col-md-12">
                <h3>Nutrient requirements:</h3>
                <div class="table-responsive">
                  <table class="table table-info" id="tableNPKrequirements">
                    <thead>
                      <tr>
                        <th scope="col">#</th>
                        <th scope="col">Crop</th>
                        <th scope="col">Yield (kg/ha)</th>
                        <th scope="col">kg N/ha</th>
                        <th scope="col">kg P/ha</th>
                        <th scope="col">kg K/ha</th>
                        <th scope="col">kg P2O5/ha</th>
                        <th scope="col">kg K2O/ha</th>
                      </tr>
                    </thead>
                    <tbody></tbody>
                  </table>
                </div>
              </div>
            </div>
          </section>
          <section id="NBalanceInputsOutputs" class="d-none">
            <div class="row">
              <div class="col-md-12">
                <h3>Farmer's initial data:</h3>
                <div class="table-responsive">
                  <table class="table table-info" id="tableNitrogenBalance">
                    <thead>
                      <tr>
                        <th scope="col">#</th>
                        <th scope="col">Crop</th>
                        <th scope="col">Mineralization</th>
                        <th scope="col">Fixation</th>
                        <th scope="col">N water</th>
                        <th scope="col">Nmin initial</th>
                        <th scope="col">Leaching</th>
                        <th scope="col">Uptake</th>
                        <th scope="col">Desnitrification</th>
                        <th scope="col">Nmin postharvest</th>
                        <th scope="col">Estimated volatilization</th>
                      </tr>
                    </thead>
                    <tbody></tbody>
                  </table>
                </div>
              </div>
            </div>
          </section>

          <form class="needs-validation" id="formFertilizersNavigatorF3" novalidate>
            <section id="sectionFertilizers" class="">
              <div class="row">
                <div class="col-md-12">
                  <div class="table-responsive">
                    <table class="table table-light" id="tableFertilizerToApply">
                      <thead>
                        <tr>
                          <th scope="col">#</th>
                          <th scope="col"></th>
                          <th scope="col">Fertilizer</th>
                          <th scope="col">Price €/kg</th>
                          <th scope="col">Nitrogen (N) %</th>
                          <th scope="col">Ureic Nitrogen (N_ure) %</th>
                          <th scope="col">Phosphorus (P) %</th>
                          <th scope="col">Potassium (K) %</th>
                          <th scope="col">Sulfur (S)%</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr class="trow" data-row="0">
                          <th scope="row">1</th>
                          <td></td>
                          <td>
                            <select class="form-select" name="fertilizers[0][fertilizerID]" required
                              onchange="onChangeFertilizer(this)">
                              <option value="">Choose...</option>
                            </select>
                            <input type="hidden" class="form-control" name="fertilizers[0][fertilizer_name]"
                              placeholder="" />
                            <input type="hidden" class="form-control" name="fertilizers[0][fertilizer_key]"
                              placeholder="" />
                          </td>
                          <td>
                            <input type="number" class="form-control" name="fertilizers[0][price]" min="0" step="any"
                              placeholder="Price fertilizer €/kg" value="0" />
                          </td>

                          <td>
                            <input type="number" class="form-control" name="fertilizers[0][N_req]" min="0" step="any"
                              placeholder="Nitrogen" value="0" />
                          </td>
                          <td>
                            <input type="number" class="form-control" name="fertilizers[0][lim_N_ur]" min="0" step="any"
                              placeholder="Ureic Nitrogen" value="0" />
                          </td>

                          <td>
                            <input type="number" class="form-control" name="fertilizers[0][P_req]" min="0" step="any"
                              placeholder="Phosphorus (P)" value="0" />
                          </td>
                          <td>
                            <input type="number" class="form-control" name="fertilizers[0][K_req]" min="0" step="any"
                              placeholder="Potassium (K)" value="0" />
                          </td>
                          <td>
                            <input type="number" class="form-control" name="fertilizers[0][S_req]" min="0" step="any"
                              placeholder="Sulfur (S) " value="0" />
                          </td>
                        </tr>
                      </tbody>
                      <tfoot>
                        <tr>
                          <td colspan="7">
                            <button type="button" class="btn btn-success" id="addFertilizer">
                              + Add fertilizer
                            </button>
                            <button type="button" class="btn btn-primary" id="btnBestFertilizer">
                              <i class="fa fa-flask"></i> I'm feeling lucky
                              (Best fertilizers)
                            </button>
                          </td>
                          <td colspan="2"></td>
                        </tr>
                      </tfoot>
                    </table>
                  </div>
                </div>
              </div>
            </section>
          </form>
        </div>
      </div>
      <br />
      <!-- STEP 3-->
      <div class="card d-none" id="step3">
        <div class="card-header">
          3.- Calculation of fertilizer requirements:
        </div>
        <div class="card-body" id="cardBodyStep3">



          <h3>External Nutrient requirements:</h3>
          <div class="table-responsive">
            <table class="table table-info" id="tableNutrientsRequirements">
              <thead>
                <tr>
                  <th scope="col">#</th>
                  <th scope="col">Crop</th>
                  <th scope="col">Yield (kg/ha)</th>
                  <th scope="col">kg N/ha</th>
                  <th scope="col">kg P/ha</th>
                  <th scope="col">kg K/ha</th>
                  <th scope="col">kg P2O5/ha</th>
                  <th scope="col">kg K2O/ha</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>

          <h3> Fertilization </h3>
          <div class="table-responsive">
            <table class="table table-info" id="tableFertilization">
              <thead>
                <tr>
                  <th scope="col">#</th>
                  <th scope="col">Crop</th>
                  <th scope="col">Fertilizer</th>
                  <th scope="col">kg N/ha</th>
                  <th scope="col">kg N_ureic/ha</th>
                  <th scope="col">kg P/ha</th>
                  <th scope="col">kg K/ha</th>
                  <th scope="col">kg S/ha</th>
                  <th scope="col">Amount</th>
                  <th scope="col">€/ha</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          <!-- 
          <h3> Nitrogen Lossed </h3>
          <div class="table-responsive">
            <table class="table table-info" id="tableNLossed">
              <thead>
                <tr>
                  <th scope="col">#</th>
                  <th scope="col">Crop</th>
                  <th scope="col">Acidification (kg/ha CO3Ca)</th>
                  <th scope="col">Volatilization</th>
                  <th scope="col">Desnitrification</th>
                  <th scope="col">Leaching</th>
                  <th scope="col">N lossed (kg/ha)</th>
                  <th scope="col">N lossed (%)</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          -->
        </div>
      </div>

      <div class="row d-none" id="stepLaunch">
        <div class="col-12 text-center">
          <button type="button" class="btn btn-primary btn-lg" id="btnLaunchF3">
            <i class="fa fa-play"></i> Launch NPK data
          </button>
        </div>
      </div>
    </div>
  </main>

  <footer class="footer mt-auto py-3 bg-light"></footer>

  <!-- JavaScript Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous">
  </script>
  <script src="https://brainfoolong.github.io/form-data-json/lib/form-data-json.min.js"></script>
  <script src="/js/form-navigator-f3.js"></script>
  <script src="/js/global-scripts.js"></script>
</body>

</html>